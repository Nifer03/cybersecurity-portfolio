Here's a basic IDS setup for detecting ICMP, SSH, DNS, and HTTP traffic on Kali Linux

Let's create custom rules for SSH, DNS and HTTP.

Create a custom rule to detect any SSH attempt
sudo nano /var/lib/suricata/rules/local.rules

Add this rule:
alert tcp any any -> any 22 (msg:"SSH connection attempt detected"; sid:1000003; rev:1;)

Test config & restart Suricata
sudo suricata -T -c /etc/suricata/suricata.yaml -v
sudo systemctl restart suricata

Run SSH test
ssh 1.1.1.1

Check logs
sudo tail -f /var/log/suricata/fast.log

You should now see:
SSH connection attempt detected.

Add a DNS Detection Rule to our local rule:

sudo nano /var/lib/suricata/rules/local.rules

Add this rule to the bottom:
alert udp any any -> any 53 (msg:"Generic DNS Query Detected"; content:"example"; nocase; sid:1000005; rev:1;)

Test the Rule & Restart Suricata
sudo suricata -T -c /etc/suricata/suricata.yaml -v
sudo systemctl restart suricata

Generate DNS Traffic
dig example.com

Check log:
sudo tail -f /var/log/suricata/fast.log

You should see:
Generic DNS Query Detected
